================================================================================
 HSP3forVSCode インストーラー                                     Version 0.9.1 
                                                                                
                                                    Copyright(C) 2023 MIZUSHIKI 
================================================================================

- 概要
--------------------------------------------------------------------------------
HSP3(スクリプト言語システム)をVSCode上で実行できるようにするために必要なセットア
ップ処理を一括で行うインストーラー。

下記項目のダウンロード＆インストール、各種設定を行います。

  HSP3.6
    - hspc (Ver.3.3.4)
    - 関連付け [OpenHspInVSCode.exe]
  VSCode
    - 文字化け、インデント、制限モード設定
    - 日本語化拡張
    - language-hsp3拡張
    - HSP3 アナライザー・ミニ (LSP)拡張
    - ショートカットキー登録


  -- HSP3環境
  ------------------------------------------------------------------------------
  Hot Soup Processor ver3.6 (安定版) (フルセット・アーカイブ版)
  - バージョン： HSP3.6 固定 (hspcがHSP3.7β未対応のため)
  - 製作者： おにたま さん (onion software)
  - 配布先： https://hsp.tv/make/downlist.html
  - オンラインマニュアル： https://www.onionsoft.net/hsp/v36/index.htm


  -- hspc
  ------------------------------------------------------------------------------
  HSP3をCUIでコンパイル/自動実行ファイル作成/実行/診断が行えるアプリケーション。
  - 製作者： ほのぼのぽー さん
  - 配布先： https://dev.onionsoft.net/seed/info.ax?id=1392
  - 使用バージョン： Ver.3.3.4(hspc334.exe) [理由は後述]


  -- language-hsp3
  ------------------------------------------------------------------------------
  VSCodeでHSP3を実行させるために必要な拡張機能。hspcと連携。
  - 製作者： ほのぼのぽー さん
  - VSCode： https://marketplace.visualstudio.com/items?itemName=honobonosun.language-hsp3


  -- HSP3 アナライザー・ミニ (LSP)
  ------------------------------------------------------------------------------
  VSCodeでHSP3の静的解析を行う拡張機能。命令にマウスホバーで説明を表示したり入力
  補完や定義箇所の参照などが行える。
  - 製作者： 令掛ベイン さん
  - VSCode： https://marketplace.visualstudio.com/items?itemName=vain0x.hsp3-analyzer-mini



- 対応OS
--------------------------------------------------------------------------------
Windows 11, 10

- Windows 8/8.1 : VSCode v1.79.2がインストールされます。(PowerShell 5.0が必要)
                  v1.79以降はWindows8/8.1対象外となりました。[2023/6/9]



- アンインストールについて
--------------------------------------------------------------------------------
ダウンロードしてきた書庫ファイルから展開／ファイルの移動を行ったり、VSCodeインス
トーラー等を利用してインストールを行っています。
アンインストールするためには下記項目を実行してください。

【HSP3】
- zipアーカイブ版を使用しています。
- レジストリ登録は行われていません。インストール先のフォルダを削除してください。
- インストール済みだった場合 sample/basicフォルダ に HelloWorld_HspInVSCode.hsp 
  が作られているので削除してください。

【hspc】
- HSP3インストールフォルダの hspc.exe, hspc334.exe を削除してください。

【VSCode】
- VSCodeのインストーラーを使用しています。（サイレントインストール）
- Windows 設定の「インストールされているアプリ」一覧からアンインストール処理を行
  ってください。

【関連付け】
- インストール後、再度このインストーラーを起動すると関連付けを解除するボタンが表
  示されます。
- HSP3インストールフォルダの OpenHspInVSCode.exe, OpenHspInVSCode.ini も削除して
  ください。

インストールの為にダウンロードした zip等の書庫ファイルはセットアップ完了後に削除
しています。



- 詳細、注意事項
--------------------------------------------------------------------------------

  -- 関連付けについて
  ------------------------------------------------------------------------------
  HSP3インストールフォルダ(hsp36フォルダ)内にOpenHspInVSCode.exeという実行ファイ
  ルを作成しています。
  この実行ファイルに.hspファイルを渡して開くとVSCodeではそのファイルとそれを含む
  フォルダを指定して開くことができます。
  
  このインストーラーで関連付けを設定することができますが、ユーザー自ら.hspファイ
  ルに関連付け設定をするよりも弱いレベルでの関連付けしかできません。
  一度でもユーザー自身によって.hspファイルに関連付けを行ったことがあると、このイ
  ンストーラーからの関連付けは効力を持ちません。
  その際は、お手数ですがWindowsの設定からOpenHspInVSCode.exeへの.hsp関連付けを行
  ってください。
  
  具体的には以下の方法で登録してください。
  .hspファイルを右クリック＞プログラムから開く＞別のプログラム＞PCでアプリを選択
  する＞hsp36\OpenHspInVSCode.exe


  -- hspcについて
  ------------------------------------------------------------------------------
  hspcのVer.3.3,4を使うようになっています。(現時点での最新版はVer.3.4.2)
  それは以下のような理由のためです。
  
  hspc Ver.3.4.2
  - VSCode上で自動実行ファイル作成が上手く動かない。
    -- hsp3root指定しないとランタイムフォルダが上手く指定されない。
       (「 #No file [C:\hsprt]」と出てしまう。)
    -- 私の環境では(?)hsp3root指定をしても「#packfile generated.」で止まる。
       (一応設定の仕方を書いておくと"language-hsp3.makeCommands"内の「-PmCa」を
        「-PmCa --hsp3root \"C:\\hsp36\"」等のように変更すれば良いはず。※１)
  - VSCode上で「実行」は問題なく動く。デバッグウィンドウも表示される。
  
  hspc Ver.3.3.4にも下記の問題があります。
  - コマンドで「w」を指定しても実行時にデバッグウィンドウが表示されない。
  
  デバッグウィンドウを表示させたい場合は、下記の手順でVSCodeのlanguage-hsp3の設
  定を一時的に変更してください。
  1. VSCodeウィンドウ左側の「拡張機能」のボタンを押す。
  2. 入力ボックスに「hsp3」と入力してインストール済みのlanguage-hsp3を見つける。
  3. language-hsp3項目の歯車ボタンを押してメニューから「拡張機能の設定」を選択。
  4. "Language-hsp3:Compiler"項目の「hspc334.exe」を「hspc.exe」に変更。
  (インストール時にhspc334.exeだけでなくhspc.exe(Ver.3.4.2)も保存されています。)
  これでデバッグウィンドウ付きで「実行」することができます。
  ただし「自動実行ファイル作成」が行えなくなります。その際は元に戻してください。

  ※１
  参考元：VSCodeでHSP3開発を超快適にしよう！ [2023年]
  https://qiita.com/umuy/items/8e8e6f1e4ccc0387be2c#code-runnercustomcommand
  ここで紹介されている通りCode Runnerを使うとVer.3.4.2でRunもMakeも出来た。
  でも「Run HSP program」と「Automatic exe file creation」のボタンが欲しい。


  -- HSP3.6（HSP3.7β未対応）について
  ------------------------------------------------------------------------------
  こちらでhspc作者ほのぼのぽーさんがHSP3.7βにはまだ未対応である旨を仰っています。
  https://twitter.com/honobonopoo/status/1675356571101167617



- HSP3forVSCode インストーラー  使用ライブラリ
--------------------------------------------------------------------------------
bregonig.dll Ver.4.20 Copyright (C) 2006-2019 K.Takata
・ライセンス： Artistic License (LICENSE_PerlArtistic.txt 参照)
・ソースコード： https://github.com/k-takata/bregonig

bregonig.dll内使用ライブラリ (Oniguruma, Onigmo, Ruby, dbgtrace.h, mem_vc6.h)
・ライセンス： BSD License (LICENSE_BSD_bregonig.txt 参照)

packdll Ver.1.01 - inovia さん
・ライセンス： BSD License - OpenHSP (LICENSE_BSD_OpenHsp.txt 参照)
・配布先： https://hsp.moe/#packdll

hspext.dll ver3.5 - copyright 1999-2016 (c) onion software
・ライセンス： free (LICENSE_HSP3DLLs.txt 参照)

hspinet.dll ver3.6 - copyright 2005-2020 (c) onion software
・ライセンス： BSD License - OpenHSP (LICENSE_HSP3DLLs.txt 参照)



- 免責、著作権、連絡先、他
--------------------------------------------------------------------------------

  -- 免責
  ------------------------------------------------------------------------------
  作者は、本ソフトウェアの使用または使用不能から生じるコンピュータの故障、情報の
  消失、その他あらゆる直接的及び間接的被害に関して一切の責任を負いません。
  
  これに同意できない場合、本ソフトウェアの使用を禁止します。


  -- 著作権
  ------------------------------------------------------------------------------
  著作権は作者である MIZUSHIKI が所有します。
  
  Copyright(C) 2023 MIZUSHIKI
  
  
  -- ソースコード
  ------------------------------------------------------------------------------
  GitHub： https://github.com/MIZUSHIKI/HSP3forVSCode_Installer
  
  または HSP3forVSCode_Inst.exeを起動して「info」ボタンからも見ることができます。


  -- 連絡先
  ------------------------------------------------------------------------------
  [作者メールアドレス]
  suwa.mizushiki@gmail.com



================================================================================

- Changelogs
--------------------------------------------------------------------------------

 0.9.1    2023/ 8/ 2
---------------------
- 出力するサンプルスクリプトを設定によって一部変更していたがしないようにした。

 0.9      2023/ 8/ 1
---------------------
- 公開。

 
================================================================================
