================================================================================
 HSP3forVSCode インストーラー                                       Version 1.0 
                                                                                
                                                    Copyright(C) 2023 MIZUSHIKI 
================================================================================

- 概要
--------------------------------------------------------------------------------
HSP3(スクリプト言語システム)をVSCode上で実行できるようにするために必要なセットア
ップ処理を一括で行うインストーラー。

下記項目のダウンロード＆インストール、各種設定を行います。

  HSP3.6
    - hspc (最新版 Ver.3.5.1 [2023/10/13現在])
    - 関連付け [OpenHspInVSCode.exe]
  VSCode
    - 文字化け、インデント、制限モード設定
    - 日本語化拡張
    - language-hsp3拡張
    - HSP3 アナライザー・ミニ (LSP)拡張
    - HSP3 Debug表示設定拡張
    - ショートカットキー登録
    - アイコンテーマ設定


  -- HSP3環境
  ------------------------------------------------------------------------------
  Hot Soup Processor ver3.6 (安定版) / ver3.7β   (フルセット・アーカイブ版)
  - バージョン： HSP3.6 / ver3.7β6 [2023/10/13現在]
  - 製作者： おにたま さん (onion software)
  - 配布先： https://hsp.tv/make/downlist.html
  - オンラインマニュアル： https://www.onionsoft.net/hsp/v36/index.htm


  -- hspc
  ------------------------------------------------------------------------------
  HSP3をCUIでコンパイル/自動実行ファイル作成/実行/診断が行えるアプリケーション。
  - 製作者： ほのぼのぽー さん
  - 配布先： https://dev.onionsoft.net/seed/info.ax?id=1392
  - バージョン： Ver.3.5.1 [2023/10/13現在]


  -- language-hsp3
  ------------------------------------------------------------------------------
  VSCodeでHSP3を実行させるために必要な拡張機能。hspcと連携。
  - 製作者： ほのぼのぽー さん
  - VSCode： https://marketplace.visualstudio.com/items?itemName=honobonosun.language-hsp3


  -- HSP3 アナライザー・ミニ (LSP)
  ------------------------------------------------------------------------------
  VSCodeでHSP3の静的解析を行う拡張機能。命令にマウスホバーで説明を表示したり入力
  補完や定義箇所の参照などが行える。
  - 製作者： 令掛ベイン さん
  - VSCode： https://marketplace.visualstudio.com/items?itemName=vain0x.hsp3-analyzer-mini



- 対応OS
--------------------------------------------------------------------------------
Windows 11, 10

Windows 8/8.1 : VSCode v1.79.2がインストールされます。
                v1.79以降はWindows8/8.1対象外となりました。[2023/6/9]
                - インストールに PowerShell 5.0以上 が必要。

Windows 7     : VSCode v1.70.2がインストールされます。
                v1.70以降はWindows7対象外となりました。[2022/7]
                - インストールに PowerShell 5.0以上 が必要。
                - InternetExplorer＞ツール＞インターネットオプション＞詳細設定
                  ＞セキュリティ＞TLS1.2の使用 にチェックを入れる。
                - インストール後、v1.70.3にアップデートできます。
                - 公開アーカイブはver.1.70.2まで。実際はver.1.70.3まで存在。

※ VSCode自動更新プログラムは「Visual Studio 2015 C++ 再頒布可能パッケージ」必要



- 既にインストール済みの項目について
--------------------------------------------------------------------------------
HSP3やVSCodeが既にインストール済みの場合、足りない項目だけインストールできる仕様
になっています。

VSCodeがインストール済みだった場合は、インストーラーの「VSCodeオプションのデフォ
ルト設定値」をインストール済みVSCodeの設定値と合わせるようにしています。
必要な項目があればチェックボタンで選択してください。
また、アイコンテーマが既にVSCodeデフォルトから変更されている場合は「アイコンテー
マ設定」の項目は実行されません。



- アンインストールについて
--------------------------------------------------------------------------------
ダウンロードしてきた書庫ファイルから展開／ファイルの移動を行ったり、VSCodeインス
トーラー等を利用してインストールを行っています。
アンインストールするためには下記項目を実行してください。

【HSP3】
- zipアーカイブ版を使用しています。
- レジストリ登録は行われていません。インストール先のフォルダを削除してください。
- インストール済みだった場合 sample/basicフォルダ に HelloWorld_HspInVSCode.hsp 
  が作られているので削除してください。

【hspc】
- HSP3インストールフォルダの hspc.exe を削除してください。

【VSCode】
- VSCodeのインストーラーを使用しています。（サイレントインストール）
- Windows 設定の「インストールされているアプリ」一覧からアンインストール処理を行
  ってください。

【関連付け】
- インストール後、再度このインストーラーを起動すると関連付けを解除するボタンが表
  示されます。
- HSP3インストールフォルダの OpenHspInVSCode.exe, OpenHspInVSCode.ini も削除して
  ください。

インストールの為にダウンロードした zip等の書庫ファイルはセットアップ完了後に削除
しています。



- インストーラーのバージョンアップにおける追加項目について
--------------------------------------------------------------------------------
バージョンアップでインストール項目が追加されることがあります。
HSP3やVSCodeがインストール済みとなっている場合、追加項目だけインストールできる仕
様にしているので特に前回の物をアンインストールする必要等はありません。
HSP3forVSCodeインストーラーを実行して頂ければ追加項目をインストールできます。



- 詳細、注意事項
--------------------------------------------------------------------------------

  -- 関連付けについて
  ------------------------------------------------------------------------------
  HSP3インストールフォルダ(hsp36フォルダ)内にOpenHspInVSCode.exeという実行ファイ
  ルを作成しています。
  この実行ファイルに.hspファイルを渡して開くとVSCodeではそのファイルとそれを含む
  フォルダを指定して開くことができます。
  
  このインストーラーで関連付けを設定することができますが、ユーザー自ら.hspファイ
  ルに関連付け設定をするよりも弱いレベルでの関連付けしかできません。
  一度でもユーザー自身によって.hspファイルに関連付けを行ったことがあると、このイ
  ンストーラーからの関連付けは効力を持ちません。
  その際は、お手数ですがWindowsの設定からOpenHspInVSCode.exeへの.hsp関連付けを行
  ってください。
  
  具体的には以下の方法で登録してください。
  .hspファイルを右クリック＞プログラムから開く＞別のプログラム＞PCでアプリを選択
  する＞hsp36\OpenHspInVSCode.exe


  -- HSP3のDebugウィンドウの表示について (local-ext-hsp3debugwin)
  ------------------------------------------------------------------------------
  HSP3Debugウィンドウの表示設定をする独自のローカル用VSCode機能拡張をインストー
  ルするようになっています。
  .hspファイルをタブに開くと右下ステータスバーに「DebugWin: show/hide」が表示さ
  れます。
  これをクリックするとshowとhideをトグル切り替えでき、Debugウィンドウを表示する
  かどうかを設定することができます。
  
  VSCode動作: "language-hsp3.runCommands"内の-wオプションを付け外しします。


  -- ポータブルzip版の対応について（裏技）
  ------------------------------------------------------------------------------
  インストーラーを起動する前に、ポータブルzip版の展開済みフォルダがHSP3forVSCode
  _Inst.exeと同じフォルダにあればインストール済みVSCodeとして認識します。
  
  ただし、ポータブルの性質上 VSCodeインストールフォルダの場所が変わったり、USBメ
  モリで運用すればドライブまで変わったりすることが考えられます。
  その場合、関連付けをしてもVSCodeの場所が不明となりエクスプローラで.hspファイル
  をダブルクリックしても起動できません。
  よって、関連付けのデフォルト値を「チェックなし」としています。


  -- VSCodeでのHSP3開発環境構築について (参考文献)
  ------------------------------------------------------------------------------
  主な参考元 : VSCodeでHSP3開発を超快適にしよう！ [2023年]
  https://qiita.com/umuy/items/8e8e6f1e4ccc0387be2c#code-runnercustomcommand
  (他にもいくつかの記事を参考にさせて頂いております。）



- HSP3forVSCode インストーラー  使用ライブラリ
--------------------------------------------------------------------------------
bregonig.dll Ver.4.20 Copyright (C) 2006-2019 K.Takata
・ライセンス： Artistic License (LICENSE_PerlArtistic.txt 参照)
・ソースコード： https://github.com/k-takata/bregonig

bregonig.dll内使用ライブラリ (Oniguruma, Onigmo, Ruby, dbgtrace.h, mem_vc6.h)
・ライセンス： BSD License (LICENSE_BSD_bregonig.txt 参照)

packdll Ver.1.01 - inovia さん
・ライセンス： BSD License - OpenHSP (LICENSE_BSD_OpenHsp.txt 参照)
・配布先： https://hsp.moe/#packdll

hspext.dll ver3.5 - copyright 1999-2016 (c) onion software
・ライセンス： free (LICENSE_HSP3DLLs.txt 参照)

hspinet.dll ver3.6 - copyright 2005-2020 (c) onion software
・ライセンス： BSD License - OpenHSP (LICENSE_HSP3DLLs.txt 参照)



- 免責、著作権、連絡先、他
--------------------------------------------------------------------------------

  -- 免責
  ------------------------------------------------------------------------------
  作者は、本ソフトウェアの使用または使用不能から生じるコンピュータの故障、情報の
  消失、その他あらゆる直接的及び間接的被害に関して一切の責任を負いません。
  
  これに同意できない場合、本ソフトウェアの使用を禁止します。


  -- 著作権
  ------------------------------------------------------------------------------
  著作権は作者である MIZUSHIKI が所有します。
  
  Copyright(C) 2023 MIZUSHIKI
  
  
  -- ソースコード
  ------------------------------------------------------------------------------
  GitHub： https://github.com/MIZUSHIKI/HSP3forVSCode_Installer
  
  または HSP3forVSCode_Inst.exeを起動して「info」ボタンからも見ることができます。


  -- 連絡先
  ------------------------------------------------------------------------------
  [作者メールアドレス]
  suwa.mizushiki@gmail.com



================================================================================

- Changelogs
--------------------------------------------------------------------------------

 1.0      2023/10/13
---------------------
- HSP3.6の他にHSP3.7β版もインストール出来るようにした。
- hspc3.5.1採用のためインストール処理の一部変更。
- ローカル用独自VSCode拡張local-ext-hsp3debugwinをインストールするようにした。
- そのほか細かい部分の変更・修正。

 0.9.4    2023/ 8/18
---------------------
- VSCode内エクスプローラのアイコンテーマ(.hsp/.as)を設定するようにした。
- VSCodeのポータブルzip版について裏技対応。
- そのほか細かい部分の変更・修正。

 0.9.3    2023/ 8/ 9
---------------------
- インストール条件が整っているか確認するようにした。
- 対応OSにWindows7を追加。
- そのほか細かい部分の変更・修正。

 0.9.2    2023/ 8/ 6
---------------------
- 制限モード(VSCode)について解説を追加。
- VSCodeインストール済みなら制限モード設定のデフォルト値を既存設定と同じにした。
- VSCodeインストール済みならインデント設定のデフォルト値を既存設定と同じにした。
- VSCode"files.autoGuessEncoding"設定済みなら上書きはせず注意文をチップに表示。
- そのほか細かい部分の変更・修正。

 0.9.1    2023/ 8/ 2
---------------------
- 出力するサンプルスクリプトを設定によって一部変更していたがしないようにした。

 0.9      2023/ 8/ 1
---------------------
- 公開。

 
================================================================================
